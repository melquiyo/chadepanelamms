<!DOCTYPE html>
<html lang="pt-BR">
<link href="https://fonts.googleapis.com/css2?family=Delius+Unicase:wght@400;700&family=Griffy&display=swap" rel="stylesheet">
<head>
<meta charset="UTF-8">
<title>Lista de Presentes - Casamento M&M‚Äôs</title>
<style>
  body {
    font-family: 'Delius Unicase', sans-serif;
    background: url("background2.jpg") no-repeat center center fixed;
    background-size: cover;
    margin: 0;
    padding: 30px;
    text-align: center;
    color: #333;
    font-size: 30px;
    font-weight: bold;
  }

  h1 {
    color: #fff;
    text-shadow: 2px 2px 5px rgba(0,0,0,0.7);
    font-family: 'Delius Unicase', serif;
  }

  p {
    color: #f9f9f9;
    font-weight: bold;
    text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
  }

  ul#lista {
    list-style: none;
    padding: 0;
    margin-top: 25px;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 25px;
    justify-items: center;
  }

  li {
    background: rgba(255, 255, 255, 0.9);
    border-radius: 15px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    padding: 15px;
    width: 250px;
    text-align: center;
    transition: transform 0.2s;
  }

  li:hover {
    transform: scale(1.03);
  }

  img {
    width: 100%;
    height: 160px;
    object-fit: cover;
    border-radius: 10px;
    margin-bottom: 10px;
  }

  span {
    display: block;
    font-weight: bold;
    margin-bottom: 8px;
    color: #222;
  }

  button {
    background: #6495ED;
    color: white;
    border: none;
    padding: 7px 15px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
  }

  button:hover {
    background: #d35b87;
  }

  @media (max-width: 600px) {
    body { padding: 15px; }
  }
</style>

<!-- Firebase -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
  import { getDatabase, ref, set, onValue, get } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDYxLGAEEFazeMo9_JXVkwRdVxOth7G9QA",
    authDomain: "casamento-mms.firebaseapp.com",
    databaseURL: "https://casamento-mms-default-rtdb.firebaseio.com/",
    projectId: "casamento-mms",
    storageBucket: "casamento-mms.firebasestorage.app",
    messagingSenderId: "152858110235",
    appId: "1:152858110235:web:3647d591b0fb05a518cbbe",
    measurementId: "G-D15NQDBWLS"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  function escolher(botao) {
    const item = botao.parentElement.querySelector("span").innerText;
    const nome = prompt("Digite seu nome para reservar este presente:");
    if (nome) {
      const itemRef = ref(db, 'presentes/' + item);
      set(itemRef, { nome: nome });
      botao.parentElement.remove();
      alert(`Obrigado, ${nome}! Voc√™ escolheu: ${item}`);
    }
  }

  function pedirSenha() {
    const senha = prompt("Digite a senha para acessar:");
    if (senha === "03092025") {
      exportarExcelFirebase();
    } else if(senha !== null) {
      alert("Senha incorreta!");
    }
  }

  async function exportarExcelFirebase() {
    const snapshot = await get(ref(db, 'presentes'));
    const dados = snapshot.val() || {};
    const listaExcel = [];
    for (let item in dados) {
      listaExcel.push({ Presente: item, Nome: dados[item].nome });
    }
    const ws = XLSX.utils.json_to_sheet(listaExcel);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Presentes");
    XLSX.writeFile(wb, "presentes_escolhidos.xlsx");
  }

  onValue(ref(db, 'presentes'), (snapshot) => {
    const dados = snapshot.val() || {};
    document.querySelectorAll('#lista li').forEach(li => {
      const nomeItem = li.querySelector('span').innerText;
      if (dados[nomeItem]) li.remove();
    });
  });

  window.escolher = escolher;
  window.pedirSenha = pedirSenha;
</script>

<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

</head>
<body>

<h1>Lista de Presentes</h1>
<p style="color: #6495ED;">Clique em "Escolher" para reservar um presente especial ‚ù§Ô∏è</p>
<p style="color: #6495ED;">N√£o achou nada na lista? Sem problema!</p>
<p style="color: #6495ED;">Voc√™ tamb√©m pode nos dar aquele empurr√£ozinho com um Pix üòÑ</p>
<p style="color: #6495ED;">Pix: mylenaibferreira@gmail.com</p>

 
<ul id="lista">
  <li><img src="airfryer.png"><span>Airfryer</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./jantar.png"><span>Aparelho de Jantar</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="banqueta.png"><span>Banqueta para bancada</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./batedeira.png"><span>Batedeira</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./cabideiro.png"><span>Cabideiro de madeira</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./cafeteira.png"><span>Cafeteira italiana</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./comoda.png"><span>C√¥moda</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./sobremesa.png"><span>Conjunto para sobremesa</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./cuscuzeira.png"><span>Cuscuzeira</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./edredoms.png"><span>Edredoms</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./espremedor.png"><span>Espremedor de Frutas</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./faqueiro.png"><span>Faqueiro</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./ferro.png"><span>Ferro de passar</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./filtro.png"><span>Filtro de √°gua (De barro)</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./forno.png"><span>Forno El√©trico</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./grill.png"><span>Grill</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./jarra.png"><span>Jarra de Vidro</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./cama.png"><span>Jogo de cama (Cores escuras)</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="copos1.png"><span>Jogo Copos</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./panelas.png"><span>Jogo de Panelas</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./talheres.png"><span>Jogo de talheres</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./tapetes.png"><span>Jogo de tapetes</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./toalha de rosto.png"><span>Jogo de toalhas de rosto</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./livreiro.png"><span>Livreiro</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="malas.png"><span>Mala de 10 kg</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./microondas.png"><span>Microondas</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./nicho.png"><span>Nichos de parede</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./pipoqueira.png"><span>Pipoqueira</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./processador.png"><span>Processador de Alimentos</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./puffs.png"><span>Puffs</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./robo.png"><span>Rob√¥ aspirador</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./sanduicheira.png"><span>Sanduicheira</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./tacas.png"><span>Ta√ßas</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="travessas.png"><span>Travessas</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./toalheiro.png"><span>Toalheiro T√©rmico</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./torradeira.png"><span>Torradeira</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./travesseiros.png"><span>Travesseiros</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./tv.png"><span>TV 50 polegadas</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./ventilador.png"><span>Ventilador</span><button onclick="escolher(this)">Escolher</button></li>
  <li><img src="./wap.png"><span>Wap</span><button onclick="escolher(this)">Escolher</button></li>
 
</ul>

<br><br>
<button onclick="pedirSenha()">Baixar lista (Apenas para os noivos)</button>

</body>
</html>

